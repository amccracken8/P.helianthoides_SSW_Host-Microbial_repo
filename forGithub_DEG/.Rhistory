fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("skyblue","white","salmon"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("skyblue","salmon"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("skyblue","white","salmon"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","darksalmon"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
grid.newpage()
library(grid)
grid.newpage()
grid.draw(p$gtable)
# Add a vertical dashed line splitting the columns 5 and 6
# Number of columns
n_col <- ncol(df_matrix)
# Column center positions in 'npc' units
x_positions <- seq(0, 1, length.out = n_col + 1)  # edges of columns
# Draw line between columns 5 and 6
grid.lines(x = unit(x_positions[6], "npc"), y = unit(c(0,1), "npc"),
gp = gpar(lty = "dashed", col = "black", lwd = 1))
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
heat.plot(complement_df,"complement cascade")
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
heat.plot(complement_df,"complement cascade")
p
grid.newpage()
grid.draw(p$gtable)
return(p)
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
heat.plot(complement_df,"complement cascade")
pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
p
grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("deepskyblue","white","salmon3"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
heat.plot <- function(df,title,lfc_cut=0.0) {
degs_cut <- degs[abs(degs$log2FoldChange) >= lfc_cut,]
df <- df[df$Gene %in% degs_cut$gene_id,]
##########.
df <- df %>%
group_by(Gene) %>%
#mutate(norm_expression = (expression - min(expression)) / (max(expression) - min(expression)))
mutate(norm_expression = 2 * ((expression - min(expression)) / (max(expression) - min(expression))) - 1)
# Pivot to wide format (genes as rows, samples as columns)
df_wide <- df %>%
select(sample, Gene, norm_expression) %>%
spread(key = sample, value = norm_expression)
# Create a vector of custom labels for the rows (annote_clean)
row_labels <- df %>%
distinct(Gene, annote_clean) %>%
arrange(match(Gene, df_wide$Gene)) %>%
pull(annote_clean)
# Step 5: Ensure that the first five samples are Naive, and the next five are Exposed
# Create a vector for column annotation
sample_labels <- ifelse(colnames(df_wide)[-1] %in% df$sample[df$group == "Naive"], "Naive", "Exposed")
# Convert the expression data (wide format) to a matrix (excluding 'unique_label' column)
df_matrix <- as.matrix(df_wide[, -1])  # Exclude 'unique_label' column
col_anno <- data.frame(group = sample_labels)
rownames(col_anno) <- colnames(df_matrix)
annotation_colors <- list(group = c("Naive" = "skyblue", "Exposed" = "salmon"))
p <- pheatmap(df_matrix,
cellwidth = 15,
cellheight = 15,
border_color = "grey20",
cluster_rows = TRUE,
cluster_cols = FALSE,
scale = "none",
color = colorRampPalette(c("springgreen3","white","purple"))(100),
show_rownames = TRUE,
show_colnames = FALSE,
#main = title,
labels_row = row_labels,
treeheight_row = 0,
treeheight_col = 0,
annotation_col = col_anno,
annotation_colors = annotation_colors,
fontsize=12
#legend = FALSE
)
#library(gridExtra)
#grid.arrange(i$gtable, t$gtable, ncol=2)
return(p)
}
#immune plots
comp <- heat.plot(complement_df,"complement cascade")
reg <- heat.plot(inflam_df,"immune regulation and cell death")
rec <- heat.plot(recog_df,"pathogen recognition and defense")
grid.arrange(comp$gtable, rec$gtable,reg$gtable, ncol=1)
#tissue plots
ecm <- heat.plot(ecm_df,"ECM")
adh <- heat.plot(adh.sig_df,"singal and adhesion")
rem <- heat.plot(rem.rep_df,"remodeling genes")
grid.arrange(comp$gtable, reg$gtable, rec$gtable, ncol=3)
