N_pc_filt <- read.csv("Naive_TOPGO_pc.csv")
N_pc_filt <- read.csv("C:/Users/andre/Desktop/GitHub/AK_Pycno_RNAxMetagen/SSWpt2_Final_Code_organized/Gene/forDryad/Naive_TOPGO_pc.csv")
N_pc_filt <- read.csv("/Users/andre/Desktop/GitHub/AK_Pycno_RNAxMetagen/SSWpt2_Final_Code_organized/Gene Ontology/forDryad/Naive_TOPGO_pc.csv")
E_pc_filt <- read.csv("/Users/andre/Desktop/GitHub/AK_Pycno_RNAxMetagen/SSWpt2_Final_Code_organized/Gene Ontology/forDryad/Exposed_TOPGO_pc.csv")
View(E_pc_filt)
N_pc_filt$gene_ratio <- N_pc_filt$Significant / N_pc_filt$Annotated
E_pc_filt$gene_ratio <- E_pc_filt$Significant / E_pc_filt$Annotated
df = N_pc_filt
### manually remove "error" causing terms and categories that are too broad > 1000 genes per category such as "metabolic process"
df <- df[!df$Annotated >= 500, ]
# Initialize the vector for redundant terms
redundant_terms <- c()
# Get the list of terms from E_elim_filt
# remove super large categories > 1000 terms
# Only GO:0140694 caused errors and was removed (membraneless organelle assembly)
GO_list <- df$GO.ID
items_to_remove <- c("GO:0140694")
GO_list <- GO_list[!GO_list %in% items_to_remove]
terms_list <- df$Term
# Iterate over each term in the list
for (i in GO_list) {
# Get parent terms for the current term
term.i = df$Term[df$GO.ID==i] # term associated with term ID.
parents <- get_parent_nodes(i)$parent_name  # Extract parent terms
parents <- parents[parents != term.i]
# Check if any parent term is already in the list of terms
if (any(parents %in% terms_list)) {
redundant_terms <- c(redundant_terms, i)
}
# add removed items to redundent terms
N_pc_final <- df[!df$GO.ID %in% redundant_terms, ]
df.p <- N_pc_final[order(N_pc_final$classicFisher), ]
#subset to top 30 or can list select significant GO terms.
df.top <- df.p %>% arrange(classicFisher)%>%
slice_head(n = 30)
## plot Naive and Exposed Enrichment
N <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(classicFisher)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(classicFisher)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
# BiocManager::install("topGO")
library(topGO)
library(GO.db)
library(tidyverse)
library(GOfuncR)
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(classicFisher)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
#subset to top 30 or can list select significant GO terms.
df.top <- df.p %>% arrange(classicFisher)%>%
slice_head(n = 30)
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(classicFisher)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
df = N_pc_filt
### manually remove "error" causing terms and categories that are too broad > 1000 genes per category such as "metabolic process"
df <- df[!df$Annotated >= 500, ]
# Initialize the vector for redundant terms
redundant_terms <- c()
# Get the list of terms from E_elim_filt
# remove super large categories > 1000 terms
# Only GO:0140694 caused errors and was removed (membraneless organelle assembly)
GO_list <- df$GO.ID
items_to_remove <- c("GO:0140694")
GO_list <- GO_list[!GO_list %in% items_to_remove]
terms_list <- df$Term
# Iterate over each term in the list
for (i in GO_list) {
# Get parent terms for the current term
term.i = df$Term[df$GO.ID==i] # term associated with term ID.
parents <- get_parent_nodes(i)$parent_name  # Extract parent terms
parents <- parents[parents != term.i]
# Check if any parent term is already in the list of terms
if (any(parents %in% terms_list)) {
redundant_terms <- c(redundant_terms, i)
}
# add removed items to redundent terms
N_pc_final <- df[!df$GO.ID %in% redundant_terms, ]
df.p <- N_pc_final[order(N_pc_final$classicFisher), ]
#subset to top 30 or can list select significant GO terms.
df.top <- df.p %>% arrange(classicFisher)%>%
slice_head(n = 30)
## plot Naive and Exposed Enrichment
N <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(classicFisher)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
N
df = E_pc_filt
### manually remove "error" causing terms and categories that are too broad > 1000 genes per category such as "metabolic process"
df <- df[!df$Annotated >= 500, ]
View(N_pc_final)
## plot Naive and Exposed Enrichment
N <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
df = E_pc_filt
### manually remove "error" causing terms and categories that are too broad > 1000 genes per category such as "metabolic process"
df <- df[!df$Annotated >= 500, ]
# Initialize the vector for redundant terms
redundant_terms <- c()
# Get the list of terms from E_elim_filt
# remove super large categories > 1000 terms
# Only GO:0140694 caused errors and was removed (membraneless organelle assembly)
GO_list <- df$GO.ID
items_to_remove <- c("GO:0140694")
GO_list <- GO_list[!GO_list %in% items_to_remove]
terms_list <- df$Term
# Iterate over each term in the list
for (i in GO_list) {
# Get parent terms for the current term
term.i = df$Term[df$GO.ID==i] # term associated with term ID.
parents <- get_parent_nodes(i)$parent_name  # Extract parent terms
parents <- parents[parents != term.i]
# Check if any parent term is already in the list of terms
if (any(parents %in% terms_list)) {
redundant_terms <- c(redundant_terms, i)
}
# add removed items to redundent terms
N_pc_final <- df[!df$GO.ID %in% redundant_terms, ]
# add removed items to redundent terms
E_pc_final <- df[!df$GO.ID %in% redundant_terms, ]
df.p <- N_pc_final[order(E_pc_final$classicFisher), ]
#subset to top 30 or can list select significant GO terms.
df.top <- df.p %>% arrange(classicFisher)%>%
slice_head(n = 30)
E <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
# combine plots
library(patchwork)
N|E
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "coral", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
E <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "pink", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "pink", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
E <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "pink", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right")
# combine plots
library(patchwork)
N|E
ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "pink", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right", axis.text.y = element_text(face = "bold"))
## plot Naive and Exposed Enrichment
N <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right", axis.text.y = element_text(face = "bold"))
E <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "pink", high = "firebrick4") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right", axis.text.y = element_text(face = "bold"))
# combine plots
library(patchwork)
N|E
df = N_pc_filt
### manually remove "error" causing terms and categories that are too broad > 1000 genes per category such as "metabolic process"
df <- df[!df$Annotated >= 500, ]
# Initialize the vector for redundant terms
redundant_terms <- c()
# Get the list of terms from E_elim_filt
# remove super large categories > 1000 terms
# Only GO:0140694 caused errors and was removed (membraneless organelle assembly)
GO_list <- df$GO.ID
items_to_remove <- c("GO:0140694")
GO_list <- GO_list[!GO_list %in% items_to_remove]
terms_list <- df$Term
# Iterate over each term in the list
for (i in GO_list) {
# Get parent terms for the current term
term.i = df$Term[df$GO.ID==i] # term associated with term ID.
parents <- get_parent_nodes(i)$parent_name  # Extract parent terms
parents <- parents[parents != term.i]
# Check if any parent term is already in the list of terms
if (any(parents %in% terms_list)) {
redundant_terms <- c(redundant_terms, i)
}
# add removed items to redundent terms
N_pc_final <- df[!df$GO.ID %in% redundant_terms, ]
df.p <- N_pc_final[order(E_pc_final$classicFisher), ]
#subset to top 30 or can list select significant GO terms.
df.top <- df.p %>% arrange(classicFisher)%>%
slice_head(n = 30)
## plot Naive and Exposed Enrichment
N <- ggplot(df.top, aes(x=-log10(classicFisher), y=reorder(Term, -log10(classicFisher)), size=Significant, color=gene_ratio)) +
scale_color_continuous(low = "skyblue", high = "darkblue") +
geom_point(alpha = 0.8) +
xlab("-log10(P-value)") +
ylab("") +
labs(color = "DEG Ratio", size="# of DEGs") +  # Change the color legend label
theme(legend.position = "right", axis.text.y = element_text(face = "bold"))
N|E
